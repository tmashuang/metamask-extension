machine:
  node:
    version: 8.0.0
  environment:
    DBUS_SESSION_BUS_ADDRESS: /dev/null
dependencies:
  pre:
    - "npm i -g testem"
    - "npm i -g mocha"
    - google-chrome --version
    - wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
    - sudo sh -c 'echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb stable main" >> /etc/apt/sources.list.d/google.list'
    - sudo apt-get update
    - sudo apt-get --only-upgrade install google-chrome-stable
    - google-chrome --version

    # Install Chrome driver
    - curl http://chromedriver.storage.googleapis.com/2.23/chromedriver_linux64.zip | gzip -dc > chromedriver
    - chmod +x chromedriver
    # Install Selenium
    - curl http://selenium-release.storage.googleapis.com/3.4/selenium-server-standalone-3.4.1.jar > selenium-server-standalone.jar
    - 'java -jar selenium-server-standalone.jar -trustAllSSLCertificates -Dwebdriver.chrome.driver=chromedriver':
        background: true

    # - wget http://chromedriver.storage.googleapis.com/2.22/chromedriver_linux32.zip
    # - unzip chromedriver_linux32.zip
    # - ./chromedriver:
    #     background: true